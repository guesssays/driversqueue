# Структура аудио файлов для офлайн озвучки табло

## Структура папок

```
public/audio/
├── ru/
│   ├── beep.mp3
│   ├── number.mp3
│   ├── please_go.mp3
│   ├── window.mp3
│   ├── digits/
│   │   ├── 0.mp3 ... 9.mp3
│   └── letters/
│       ├── A.mp3 ... Z.mp3
├── uzLat/
│   ├── beep.mp3
│   ├── number.mp3
│   ├── window.mp3 (fallback)
│   ├── window_suffix.mp3
│   ├── go.mp3 (опционально)
│   ├── digits/
│   │   ├── 0.mp3 ... 9.mp3
│   ├── ordinals/
│   │   ├── 1.mp3 (birinchi)
│   │   ├── 2.mp3 (ikkinchi)
│   │   ├── 3.mp3 (uchinchi)
│   │   ├── 4.mp3 (to'rtinchi)
│   │   ├── 5.mp3 (beshinchi)
│   │   └── 6.mp3 (oltinchi)
│   └── letters/
│       ├── A.mp3 ... Z.mp3
└── uzCyr/
    ├── beep.mp3
    ├── number.mp3
    ├── window.mp3 (fallback)
    ├── window_suffix.mp3
    ├── go.mp3 (опционально)
    ├── digits/
    │   ├── 0.mp3 ... 9.mp3
    ├── ordinals/
    │   ├── 1.mp3 (биринчи)
    │   ├── 2.mp3 (иккинчи)
    │   ├── 3.mp3 (учинчи)
    │   ├── 4.mp3 (тўртинчи)
    │   ├── 5.mp3 (бешинчи)
    │   └── 6.mp3 (олтинчи)
    └── letters/
        ├── A.mp3 ... Z.mp3
```

## Описание файлов

### Обязательные файлы в корне каждой языковой папки:

- **beep.mp3** - короткий "пик" перед объявлением (сигнал внимания, опционально)
- **number.mp3** - слово "Номер" / "Navbat raqami" / "Навбат рақами"
- **window.mp3** - слово "окно" (для ru; для uzLat/uzCyr используется как fallback)
- **window_suffix.mp3** - суффикс "oynaga" (uzLat) / "ойнага" (uzCyr) - обязателен для uzLat/uzCyr
- **go.mp3** - опционально для uzLat/uzCyr (если отсутствует - пропускается)
- **please_go.mp3** - устаревший файл, больше не используется

### Папка digits/ (обязательно):

- **0.mp3 ... 9.mp3** - озвучка цифр от 0 до 9
- Для uzLat/uzCyr используется как fallback если ordinals отсутствует

### Папка ordinals/ (обязательно для uzLat/uzCyr):

- **1.mp3 ... 6.mp3** - порядковые числительные для номеров окон
- **uzLat:** birinchi (1), ikkinchi (2), uchinchi (3), to'rtinchi (4), beshinchi (5), oltinchi (6)
- **uzCyr:** биринчи (1), иккинчи (2), учинчи (3), тўртинчи (4), бешинчи (5), олтинчи (6)
- Если файл отсутствует для конкретного номера окна (1-6), используется fallback на digits/

### Папка letters/ (обязательно):

- **A.mp3 ... Z.mp3** - озвучка букв латинского алфавита (для номеров талонов типа "T-002", "R-001", "A12")

## Формат файлов

- Формат: MP3 или WAV
- Рекомендуемый битрейт: 128 kbps для MP3
- Рекомендуемая частота дискретизации: 44.1 kHz
- Моно или стерео - на выбор

## Порядок воспроизведения

### Для uzLat/uzCyr:
При вызове талона "T-001" к окну "3" воспроизводится последовательность:

1. `beep.mp3` - сигнал (опционально)
2. `number.mp3` - "Navbat raqami" / "Навбат рақами"
3. `letters/T.mp3` - "T"
4. `digits/0.mp3` - "0"
5. `digits/0.mp3` - "0"
6. `digits/1.mp3` - "1"
7. `ordinals/3.mp3` - "uchinchi" / "учинчи" (порядковое числительное для окна 3)
8. `window_suffix.mp3` - "oynaga" / "ойнага"
9. `go.mp3` - опционально (если отсутствует - пропускается)

**Результат:** "Navbat raqami T 0 0 1. uchinchi oynaga." / "Навбат рақами T 0 0 1. учинчи ойнага."

**Fallback логика:**
- Если `ordinals/{window}.mp3` отсутствует (404) → используется `digits/{window}.mp3` (например, "3" вместо "uchinchi")
- Если `window_suffix.mp3` отсутствует → используется `window.mp3` ("oyna" вместо "oynaga")
- Если `go.mp3` отсутствует → просто пропускается

### Для ru:
При вызове талона "T-001" к окну "3" воспроизводится последовательность:

1. `beep.mp3` - сигнал (опционально)
2. `number.mp3` - "Номер"
3. `letters/T.mp3` - "T"
4. `digits/0.mp3` - "0"
5. `digits/0.mp3` - "0"
6. `digits/1.mp3` - "1"
7. `window.mp3` - "окно"
8. `digits/3.mp3` - "3"

## Обработка ошибок и fallback

### Для uzLat/uzCyr:

1. **ordinals/{window}.mp3:**
   - Если отсутствует для окна 1-6 → fallback на `digits/{window}.mp3`
   - Если номер окна вне диапазона 1-6 → всегда используется `digits/`

2. **window_suffix.mp3:**
   - Если отсутствует → fallback на `window.mp3`

3. **go.mp3:**
   - Если отсутствует → просто пропускается (не критично)

4. **Другие файлы:**
   - Если отсутствуют → выводится предупреждение в консоль (`console.warn`)
   - Файл пропускается, воспроизведение продолжается
   - Табло не прерывает работу

### Для ru:
- Если файл отсутствует → выводится предупреждение, файл пропускается

## Примечания

- Дефис в номерах талонов (например, "T-002") не озвучивается
- Все буквы приводятся к верхнему регистру перед поиском файла
- Система работает полностью офлайн, без внешних API
- Аудио файлы предзагружаются перед воспроизведением для уменьшения пауз
- Между клипами есть небольшие паузы (60ms по умолчанию, 10ms перед window_suffix)
- Порядковые числительные используются только для узбекских языков (uzLat/uzCyr) и только для окон 1-6
